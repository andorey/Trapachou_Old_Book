<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>five_point</title>
	<style>
        #game {
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            table-layout: fixed;
        }

        #game > div {
            display: flex;
        }

        #game > div > div {
            width: 20px;
            height: 20px;
            padding: 0;
            border: 1px solid darkgray;
        }

        .player1 {
            background: red;
            border-radius: 50%;
        }

        .player2 {
            background: cornflowerblue;
            border-radius: 50%;
        }
	</style>
</head>
<body>
<div id="game"></div>

<script>
    const game = document.getElementById('game');
    let columnNum = Math.floor(window.innerWidth / 22);
    let rowsNum = Math.floor(window.innerHeight / 22);
    let nextGamer = 0;
    let lineCheck = [];
    

    const fillField = function (game, columnNum, rowsNum) {
        for (let i = 0; i < rowsNum; i++) {
            lineCheck[i] = []
            let div = document.createElement('div');
            
            for (let j = 0; j < columnNum; j++) {
                let div2 = document.createElement('div');
                
                div2.addEventListener('click', function (event) {
                    if (!nextGamer && this.className === '') {
                        this.className = 'player1';
                        nextGamer = 1;
                    } else if (nextGamer && this.className === '') {
                        this.className = 'player2';
                        nextGamer = 0;
                    } else if (this.className && event.shiftKey) {
                        this.className = '';
                        nextGamer = !nextGamer;
                    }
                    
                    lineCheck[i][j] = div2.className === 'player1' ? 3 : div2.className === 'player2' ? 5 : 0;
                    lineRow(lineCheck);
                    lineColumn(lineCheck);
                    diagonalLeft(lineCheck);
                    diagonalRight(lineCheck)
                })
                div.appendChild(div2)
            }
            game.appendChild(div)
        }
    }

    fillField(game, columnNum, rowsNum)
	
	function whoWinner(str) {
        let winner = '';
        if(str.includes('33333')){ winner = 'Player 1' }
        if(str.includes('55555')){ winner = 'Player 2' }
        if(winner){
            alert('\f ' + winner + '\nis Winner!');
            location.reload()
        }
    }
	
	function lineRow(arr) {
		for (let i of arr){
			whoWinner(i.join(''))
		}
    }
    
    function lineColumn(arr) {
        let column = '';
		for(let i = 0; i < columnNum; i++){
		    for(let j = 0; j < rowsNum; j++){
		        column = column.concat( arr[j][i] )
			}
            whoWinner(column)
		}
    }
	
    function diagonalLeft(arr) {
        let diagonal = [];
        for ( let i = 0; i < rowsNum; i++){
            for (let j = 0; j < columnNum; j++){
                diagonal[i + j] = diagonal[i + j] === undefined ? [] : diagonal[i + j];
                diagonal[i + j].push(arr[i][j])
			}
        }
        lineRow(diagonal)
    }

    function diagonalRight(arr) {
        let diagonal = []
        for ( let i = 0; i < rowsNum; i++){
            for (let j = columnNum - 1; j >= 0; j--){
                diagonal[i] = diagonal[i] === undefined ? [] : diagonal[i];
                diagonal[i].push(arr[i][j]);
            }
        }
        diagonalLeft(diagonal)
    }
	
</script>
</body>
</html>