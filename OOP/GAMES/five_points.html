<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>five_point</title>
	<style>
        #game {
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            table-layout: fixed;
        }

        #game > div {
            display: flex;
        }

        #game > div > div {
            width: 20px;
            height: 20px;
            margin: 0.5px;
            border: 1px solid lightgray;
        }

        .player1 {
            background: red;
            border-radius: 50%;
        }

        .player2 {
            background: #64edc8;
            border-radius: 50%;
        }
		
		.field{
			position: absolute;
			top: 0;
			left: 0;
            display: flex;
			flex-direction: column;
            flex-wrap: wrap;
            justify-content: space-between;
            align-content: space-around;
            align-items: center;
			text-shadow: black 2px 3px 2px;
			height: 100%;
			width: 100%;
			color: white;
			font-size: 5em;
			font-weight: bold;
			background-color: rgba(1, 1, 1, 0.15)
		}
		
		.button{
			margin-bottom: 40px;
			font-size: 18px;
			background: #004351;
			color: white;
			text-shadow: black 4px 5px 2px;
			padding: 10px 20px;
			border-radius: 9px;
			box-shadow: black 0 0 5px;
		}
	</style>
</head>
<body>
<div id="game"></div>

<script>
    const game = document.getElementById('game');
    let columnNum = Math.floor(window.innerWidth / 23);
    let rowsNum = Math.floor(window.innerHeight / 24);
    let winner = '';
    let nextGamer = 0;
    let lineCheck = [];
    

    const fillField = function (game, columnNum, rowsNum) {
        for (let i = 0; i < rowsNum; i++) {
            lineCheck[i] = []
            let div = document.createElement('div');
            
            for (let j = 0; j < columnNum; j++) {
                let div2 = document.createElement('div');
                lineCheck[i][j] = div2.className ? 1 : 0;
                
                div2.addEventListener('click', function (event) {
                    if (!nextGamer && this.className === '') {
                        this.className = 'player1';
                        nextGamer = 1;
                    } else if (nextGamer && this.className === '') {
                        this.className = 'player2';
                        nextGamer = 0;
                    } else if (this.className && event.shiftKey) {
                        this.className = '';
                        nextGamer = !nextGamer;
                    }
                    
                    lineCheck[i][j] = div2.className === 'player1' ? 3 : div2.className === 'player2' ? 5 : 0;
                    
                    lineRow(lineCheck);
                    lineColumn(lineCheck);
                    diagonalLeft(lineCheck);
                    diagonalRight(lineCheck)
                })
                div.appendChild(div2)
            }
            game.appendChild(div)
        }
    }

    fillField(game, columnNum, rowsNum)
	
	function lineRow(arr) {
		for (let i of arr){
            if(i.join('').includes('33333')){ winner = 'Player 1' }
            if(i.join('').includes('55555')){ winner = 'Player 2' }
		}
        if(winner){
            alert('\f ' + winner + '\nis Winner!');
            restartGame()
        }
    }
	
    function lineColumn(arr) {
        let column = [];
		for(let i = 0; i < columnNum; i++){
		    column[i] = [];
		    for(let j = 0; j < rowsNum; j++){
		        column[i][j] = arr[j][i] ? arr[j][i] : 0;
			}
		}
        console.log(column)
        lineRow(column)
    }
	
    function diagonalLeft(arr) {
        let diagonal = [];
        for ( let i = 0; i < rowsNum; i++){
            for (let j = 0; j < columnNum; j++){
                diagonal[i + j] = diagonal[i + j] === undefined ? [] : diagonal[i + j];
                diagonal[i + j].push(arr[i][j])
			}
        }
        lineRow(diagonal)
    }

    function diagonalRight(arr) {
        let diagonal = []
        for ( let i = 0; i < rowsNum; i++){
            for (let j = columnNum - 1; j >= 0; j--){
                diagonal[i] = diagonal[i] === undefined ? [] : diagonal[i];
                diagonal[i].push(arr[i][j]);
            }
        }
        diagonalLeft(diagonal)
    }
    
    function restartGame() {
		let body = document.querySelector('body')
		let div = document.createElement('div')
		div.className = 'field';
		div.innerText = 'GAME OVER\n\f' + winner + ' wins!';
		body.appendChild(div)
		let button = document.createElement('button')
		button.innerHTML = 'RESTART'
		button.className = 'button'
		div.appendChild(button)
		button.addEventListener('click', () => location.reload())
    }
	
</script>
</body>
</html>